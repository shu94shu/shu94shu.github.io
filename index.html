<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç ”ç©¶ç”Ÿè°ˆå¿ƒè°ˆè¯é‡ç‚¹å¯¹è±¡æ¸¸æˆåŒ–æ™®æŸ¥é—®å·</title>
    <style>
        /* æ ·å¼ä¿æŒä¸å˜ï¼Œä»…è°ƒæ•´æˆå°±å›¾æ ‡ç›¸å…³æ ·å¼ */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
        }
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e4edf5 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        .game-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(90deg, #4b6cb7 0%, #182848 100%);
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
        }
        .header h1 {
            font-size: 2.2em;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        .header p {
            font-size: 1.1em;
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }
        .game-content {
            padding: 30px;
        }
        .screen {
            display: none;
        }
        .active {
            display: block;
            animation: fadeIn 0.5s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .start-screen {
            text-align: center;
            padding: 40px 20px;
        }
        .start-screen img {
            width: 150px;
            height: 150px;
            object-fit: contain;
            margin-bottom: 25px;
            border-radius: 50%;
            background: #eef2f7;
            padding: 15px;
        }
        .start-screen h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        .start-screen p {
            margin-bottom: 30px;
            color: #555;
            font-size: 1.1em;
            line-height: 1.7;
        }
        .btn {
            background: linear-gradient(90deg, #4cc9f0 0%, #4361ee 100%);
            color: white;
            border: none;
            padding: 14px 35px;
            font-size: 1.1em;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(67, 97, 238, 0.3);
        }
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(67, 97, 238, 0.4);
        }
        .btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .question-screen {
            padding: 20px 0;
        }
        .stage-title {
            background: #e9ecef;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 25px;
            font-weight: bold;
            color: #2c3e50;
            border-left: 5px solid #4361ee;
        }
        .question {
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px dashed #eee;
        }
        .question:last-child {
            border-bottom: none;
        }
        .question p {
            font-size: 1.2em;
            margin-bottom: 18px;
            color: #2b2d42;
            line-height: 1.5;
        }
        .options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        .option {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: left;
        }
        .option:hover {
            background: #edf2f7;
            border-color: #4cc9f0;
        }
        .option.selected {
            background: #e3f2fd;
            border-color: #4361ee;
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        .option input {
            display: none;
        }
        .option-label {
            display: flex;
            align-items: flex-start;
        }
        .option-icon {
            font-size: 1.4em;
            margin-right: 12px;
            min-width: 24px;
        }
        .next-btn-container {
            text-align: center;
            margin-top: 20px;
        }
        .note {
            background: #fff8e1;
            padding: 15px;
            border-radius: 10px;
            margin-top: 20px;
            border-left: 4px solid #ffc107;
            font-size: 0.95em;
            color: #5d4037;
        }
        .result-screen {
            text-align: center;
            padding: 30px 20px;
        }
        .score-display {
            font-size: 5em;
            font-weight: bold;
            background: linear-gradient(90deg, #06d6a0 0%, #118ab2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 20px 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        .level {
            font-size: 2.5em;
            margin: 25px 0;
            color: #2b2d42;
        }
        .report {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            text-align: left;
            margin: 25px 0;
            line-height: 1.8;
        }
        .report h3 {
            color: #4361ee;
            margin-bottom: 15px;
            font-size: 1.4em;
        }
        .report p {
            margin-bottom: 15px;
            color: #495057;
        }
        .achievements {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
        }
        .achievement {
            display: none;
            flex-direction: column;
            align-items: center;
            background: #e3f2fd;
            border: 2px solid #4361ee;
            border-radius: 10px;
            padding: 15px;
            width: 140px;
            transition: all 0.3s ease;
        }
        .achievement.unlocked {
            display: flex;
            animation: bounceIn 0.5s ease;
        }
        @keyframes bounceIn {
            0% { transform: scale(0); opacity: 0; }
            60% { transform: scale(1.1); }
            100% { transform: scale(1); opacity: 1; }
        }
        /* æ–°å¢æˆå°±å›¾æ ‡æ ·å¼ï¼Œæ›¿æ¢åŸå›¾ç‰‡æ ·å¼ */
        .achievement-icon {
            font-size: 2.5em;
            margin-bottom: 8px;
        }
        .achievement h4 {
            font-size: 1.1em;
            margin: 0;
            color: #4361ee;
        }
        .restart-btn {
            background: linear-gradient(90deg, #ff9e00 0%, #ff6b00 100%);
            margin-top: 10px;
        }
        .hidden-input {
            margin-top: 10px;
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1em;
        }
        .multi-select {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        .multi-option {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }
        .multi-option.selected {
            background: #e3f2fd;
            border: 2px solid #4361ee;
        }
        .progress-container {
            width: 100%;
            background: #e9ecef;
            border-radius: 10px;
            margin: 15px 0;
            overflow: hidden;
            height: 10px;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4cc9f0 0%, #4361ee 100%);
            width: 0%;
            transition: width 0.3s ease;
        }
        .stage-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.9em;
            color: #6c757d;
        }
        .info-form {
            max-width: 500px;
            margin: 0 auto;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #2b2d42;
        }
        .form-group input, 
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1em;
        }
        .info-screen {
            padding: 20px 0;
        }
        .character-preview {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            text-align: left;
        }
        .character-preview h4 {
            margin-bottom: 10px;
            color: #4361ee;
        }
        .character-preview p {
            margin: 5px 0;
            color: #495057;
        }
        .error-message {
            color: #e74c3c;
            font-size: 0.9em;
            margin-top: 5px;
            display: none;
        }
        .submit-success-screen {
            text-align: center;
            padding: 40px 20px;
        }
        .success-icon {
            font-size: 5em;
            color: #06d6a0;
            margin-bottom: 20px;
        }
        .submit-success-screen h2 {
            color: #2c3e50;
            margin-bottom: 20px;
        }
        .submit-success-screen p {
            color: #555;
            font-size: 1.1em;
            margin-bottom: 30px;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="header">
            <h1>ç ”ç©¶ç”Ÿè°ˆå¿ƒè°ˆè¯é‡ç‚¹å¯¹è±¡æ¸¸æˆåŒ–æ™®æŸ¥é—®å·</h1>
            <p>é€šè¿‡æ¸¸æˆåŒ–é—¯å…³ï¼Œè½»æ¾å®Œæˆå¿ƒç†ä¸ç”Ÿæ´»çŠ¶æ€è¯„ä¼°</p>
        </div>
        <div class="game-content">
            <!-- å¼€å§‹å±å¹• -->
            <div id="start-screen" class="screen active">
                <div class="start-screen">
                    <img src="https://bailian-bmp-pre.oss-cn-hangzhou.aliyuncs.com/public/system_agent/PlaceHolder.png" alt="æ¸¸æˆåŒ–é—®å·">
                    <h2>å¼€å¯ä½ çš„æ ¡å›­ç”Ÿå­˜æŒ‘æˆ˜</h2>
                    <p>æœ¬é—®å·ä»¥æ¸¸æˆåŒ–å½¢å¼è®¾è®¡ï¼Œå…±9å…³æŒ‘æˆ˜ï¼Œå¸®ä½ å…¨é¢è¯„ä¼°å­¦ä¹ ã€ç”Ÿæ´»ã€å¿ƒç†çŠ¶æ€ã€‚<br>æ‰€æœ‰æ•°æ®ä»…ç”¨äºå­¦æ ¡å…³æ€€æ”¯æŒï¼Œä¸¥æ ¼ä¿å¯†ï¼Œè¯·æ”¾å¿ƒå¡«å†™ã€‚</p>
                    <button id="start-btn" class="btn">å¼€å§‹é—¯å…³</button>
                </div>
            </div>

            <!-- ä¿¡æ¯å¡«å†™å±å¹• -->
            <div id="info-screen" class="screen">
                <div class="info-screen">
                    <h2 style="text-align: center; color: #2c3e50; margin-bottom: 25px;">è§’è‰²åˆ›å»º</h2>
                    <p style="text-align: center; margin-bottom: 25px; color: #555;">è¯·å¡«å†™åŸºæœ¬ä¿¡æ¯ï¼Œåˆ›å»ºä½ çš„æ ¡å›­ç”Ÿå­˜è§’è‰²ï¼ˆå¡«å†™å®Œæˆå³å¯è·å¾—20åˆ†åŸºç¡€åˆ†ï¼‰</p>
                    
                    <div class="info-form">
                        <div class="form-group">
                            <label for="student-id">å­¦å· *</label>
                            <input type="text" id="student-id" placeholder="è¯·è¾“å…¥8ä½å­¦å·">
                            <div class="error-message" id="student-id-error">è¯·è¾“å…¥æœ‰æ•ˆçš„8ä½å­¦å·</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="name">å§“å *</label>
                            <input type="text" id="name" placeholder="è¯·è¾“å…¥å§“å">
                            <div class="error-message" id="name-error">è¯·è¾“å…¥å§“å</div>
                        </div>
                        
                        <div class="form-group">
                            <label>æ€§åˆ« *</label>
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                                <div class="option gender-option" data-value="ç”·">
                                    <div class="option-label">
                                        <span class="option-icon">ğŸš¹</span>
                                        <span>ç”·</span>
                                    </div>
                                </div>
                                <div class="option gender-option" data-value="å¥³">
                                    <div class="option-label">
                                        <span class="option-icon">ğŸšº</span>
                                        <span>å¥³</span>
                                    </div>
                                </div>
                                <div class="option gender-option" data-value="å…¶ä»–">
                                    <div class="option-label">
                                        <span class="option-icon">âš§ï¸</span>
                                        <span>å…¶ä»–</span>
                                    </div>
                                </div>
                            </div>
                            <div class="error-message" id="gender-error">è¯·é€‰æ‹©æ€§åˆ«</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="grade">å¹´çº§ *</label>
                            <select id="grade">
                                <option value="">è¯·é€‰æ‹©å¹´çº§</option>
                                <option value="ç¡•å£«ä¸€å¹´çº§">ç¡•å£«ä¸€å¹´çº§</option>
                                <option value="ç¡•å£«äºŒå¹´çº§">ç¡•å£«äºŒå¹´çº§</option>
                                <option value="ç¡•å£«ä¸‰å¹´çº§">ç¡•å£«ä¸‰å¹´çº§</option>
                            </select>
                            <div class="error-message" id="grade-error">è¯·é€‰æ‹©å¹´çº§</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="teacher">å¯¼å¸ˆ *</label>
                            <input type="text" id="teacher" placeholder="è¯·è¾“å…¥å¯¼å¸ˆåç§°">
                            <div class="error-message" id="teacher-error">è¯·è¾“å…¥å¯¼å¸ˆåç§°</div>
                        </div>
                        
                        <div class="form-group">
                            <label for="major">ä¸“ä¸š *</label>
                            <input type="text" id="major" placeholder="è¯·è¾“å…¥ä¸“ä¸šåç§°">
                            <div class="error-message" id="major-error">è¯·è¾“å…¥ä¸“ä¸šåç§°</div>
                        </div>
                        
                        <div class="character-preview">
                            <h4>ä½ çš„è§’è‰²é¢„è§ˆ</h4>
                            <p><strong>èº«ä»½ï¼š</strong> <span id="preview-role">ä¸Šå¤§èŒæ–°é¼ ï¼ˆçŠ¶æ€å¾…å®šï¼‰</span></p>
                            <p><strong>å®—é—¨å¸ˆæ‰¿ï¼š</strong> <span id="preview-college-major">æœªè®¾ç½®</span></p>
                            <p><strong>å¹´çº§ï¼š</strong> <span id="preview-grade">æœªè®¾ç½®</span></p>
                            <p><strong>å½“å‰å¾—åˆ†ï¼š</strong> <span id="base-score">0</span>ï¼ˆåŸºç¡€åˆ†ï¼‰</p>
                        </div>
                        
                        <div class="next-btn-container">
                            <button id="info-next-btn" class="btn" disabled>åˆ›å»ºè§’è‰²å¹¶å¼€å§‹é—¯å…³</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- é—®é¢˜å±å¹• -->
            <div id="question-screen" class="screen">
                <div class="question-screen">
                    <div class="stage-indicator">
                        <span>å…³å¡: <span id="current-stage">1</span>/9</span>
                        <span>å¾—åˆ†: <span id="current-score">20</span></span>
                    </div>
                    <div class="progress-container">
                        <div class="progress-bar" id="progress-bar"></div>
                    </div>
                    <div id="stage-title" class="stage-title"></div>
                    <div id="questions-container"></div>
                    <div class="next-btn-container">
                        <button id="next-btn" class="btn" disabled>è¿›å…¥ä¸‹ä¸€å…³</button>
                    </div>
                    <div id="note-container" class="note" style="display:none;"></div>
                </div>
            </div>

            <!-- ç»“ç®—å±å¹• - æˆå°±æ›¿æ¢ä¸ºUnicodeå›¾æ ‡ -->
            <div id="result-screen" class="screen">
                <div class="result-screen">
                    <h2>é—¯å…³ç»“ç®—ï¼šç”Ÿå­˜ç­‰çº§ä¸å¾—åˆ†æŠ¥å‘Š</h2>
                    <div class="score-display" id="final-score">--</div>
                    <div class="level" id="survival-level">è®¡ç®—ä¸­...</div>
                    
                    <div class="report">
                        <h3>ä½ çš„æ ¡å›­ç”Ÿå­˜çŠ¶æ€åˆ†æ</h3>
                        <p id="report-text"></p>
                    </div>
                    
                    <h3 style="color: #2c3e50; margin: 25px 0 15px;">ä½ è·å¾—çš„æˆå°±</h3>
                    <div class="achievements">
                        <!-- å®¶åº­å’Œç¦æ˜Ÿ - ğŸ  -->
                        <div class="achievement" id="family-achievement">
                            <span class="achievement-icon">ğŸ </span>
                            <h4>å®¶åº­å’Œç¦æ˜Ÿ</h4>
                        </div>
                        <!-- æ€æƒ³é¢†èˆªå‘˜ - ğŸ“š -->
                        <div class="achievement" id="ideology-achievement">
                            <span class="achievement-icon">ğŸ“š</span>
                            <h4>æ€æƒ³é¢†èˆªå‘˜</h4>
                        </div>
                        <!-- ç§‘ç ”å¤§ä½¬ - ğŸ”¬ -->
                        <div class="achievement" id="research-achievement">
                            <span class="achievement-icon">ğŸ”¬</span>
                            <h4>ç§‘ç ”å¤§ä½¬</h4>
                        </div>
                        <!-- å¯¼å­¦é»˜å¥‘ç‹ - ğŸ¤ -->
                        <div class="achievement" id="mentor-achievement">
                            <span class="achievement-icon">ğŸ¤</span>
                            <h4>å¯¼å­¦é»˜å¥‘ç‹</h4>
                        </div>
                        <!-- äººé™…å°å¤ªé˜³ - â˜€ï¸ -->
                        <div class="achievement" id="social-achievement">
                            <span class="achievement-icon">â˜€ï¸</span>
                            <h4>äººé™…å°å¤ªé˜³</h4>
                        </div>
                        <!-- èŒä¸šè§„åˆ’å¸ˆ - ğŸ“ˆ -->
                        <div class="achievement" id="career-achievement">
                            <span class="achievement-icon">ğŸ“ˆ</span>
                            <h4>èŒä¸šè§„åˆ’å¸ˆ</h4>
                        </div>
                    </div>
                    
                    <button id="submit-data-btn" class="btn submit-btn">æäº¤é—®å·æ•°æ®</button>
                    <button id="restart-btn" class="btn restart-btn">é‡æ–°å¼€å§‹</button>
                    <p style="margin-top: 20px; color: #6c757d; font-size: 0.9em;">æäº¤åå­¦æ ¡å°†æ ¹æ®ç»“æœæä¾›é’ˆå¯¹æ€§æ”¯æŒ</p>
                </div>
            </div>

            <!-- æäº¤æˆåŠŸå±å¹• -->
            <div id="submit-success-screen" class="screen">
                <div class="submit-success-screen">
                    <div class="success-icon">âœ…</div>
                    <h2>é—®å·æäº¤æˆåŠŸï¼</h2>
                    <p>ä½ çš„ä¿¡æ¯å·²æˆåŠŸæäº¤ï¼Œå­¦æ ¡å°†æ ¹æ®ä½ çš„å¡«å†™æƒ…å†µæä¾›ç›¸åº”çš„å…³æ€€å’Œæ”¯æŒã€‚</p>
                    <p>æ„Ÿè°¢ä½ çš„é…åˆï¼Œå¦‚æœ‰ä»»ä½•é—®é¢˜å¯è”ç³»è¾…å¯¼å‘˜ã€‚</p>
                    <button id="back-to-home-btn" class="btn">è¿”å›é¦–é¡µ</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ¸¸æˆæ•°æ®å®šä¹‰ - 100åˆ†åˆ¶åˆ†å€¼ä½“ç³»
        const quizData = [
            {
                id: 'family',
                title: 'ç¬¬ä¸€å…³ï¼šå®¶åº­æ¸¯æ¹¾ï¼ˆå®¶åº­å…³ç³»ç»´åº¦ãƒ»ç»´åº¦åˆ† 7åˆ†)',
                achievement: 'å®¶åº­å’Œç¦æ˜Ÿ',
                achievementId: 'family-achievement',
                questions: [
                    {
                        text: 'æœ€è¿‘å®¶é‡Œæ˜¯å¦å‡ºç° "å‰§æƒ…åè½¬"ï¼Ÿ',
                        options: [
                            { text: 'ğŸ¡ å²æœˆé™å¥½ï¼šæ— ä»»ä½•å˜æ•…', score: 4, risk: 0, icon: 'ğŸ¡' },
                            { text: 'ğŸŒŠ å°æ³¢æ¾œï¼šæœ‰å°å˜åŒ–ä½†"é—®é¢˜ä¸å¤§"', score: 1, risk: 0, icon: 'ğŸŒŠ' },
                            { text: 'ğŸŒªï¸ å¤§é£æš´ï¼šæœ‰é‡å¤§å˜æ•…ï¼Œæ„Ÿè§‰"å¤©éƒ½è¦å¡Œäº†"', score: 0, risk: 3, icon: 'ğŸŒªï¸' }
                        ]
                    },
                    {
                        text: 'ä½ å’Œçˆ¶æ¯çš„èŠå¤©æ¨¡å¼æ˜¯ï¼Ÿ',
                        options: [
                            { text: 'ğŸ“± æ— è¯ä¸è°ˆï¼šæ¯å¤©éƒ½è¦ "è§†é¢‘é€šè¯"', score: 3, risk: 0, icon: 'ğŸ“±' },
                            { text: 'ğŸ“… å¶å°”è”ç³»ï¼šèŠ‚æ—¥é—®å€™ï¼Œ"æŠ¥å–œä¸æŠ¥å¿§"', score: 1, risk: 0, icon: 'ğŸ“…' },
                            { text: 'ğŸ”‡ åŸºæœ¬ä¸èŠï¼š"è¯ä¸æŠ•æœºåŠå¥å¤š"', score: 0, risk: 0, icon: 'ğŸ”‡' }
                        ]
                    }
                ]
            },
            {
                id: 'ideology',
                title: 'ç¬¬äºŒå…³ï¼šæ€æƒ³é¢†èˆªï¼ˆæ€æƒ³æ”¿æ²»ç»´åº¦ãƒ»ç»´åº¦åˆ† 10åˆ†)',
                achievement: 'æ€æƒ³é¢†èˆªå‘˜',
                achievementId: 'ideology-achievement',
                questions: [
                    {
                        text: 'å¦‚æœç†è®ºå­¦ä¹ æ˜¯ä¸€åœºç›´æ’­ï¼Œä½ æ˜¯å“ªç§è§‚ä¼—ï¼Ÿ',
                        options: [
                            { text: 'ğŸš¶â€â™€ï¸ ä»ä¸çœ‹ç›´æ’­ï¼Œç›´æ¥åˆ’èµ°', score: 0, risk: 0, icon: 'ğŸš¶â€â™€ï¸' },
                            { text: 'ğŸ• å¶å°”è·¯è¿‡ï¼Œåœç•™å‡ ç§’', score: 1, risk: 0, icon: 'ğŸ•' },
                            { text: 'âœ… å®šæœŸæ‰“å¡ï¼Œå‡†æ—¶ç­¾åˆ°', score: 4, risk: 0, icon: 'âœ…' }
                        ]
                    },
                    {
                        text: 'æœ€è¿‘ä½ æ˜¯å¦å¯¹ä¸€äº›å¤§å®¶ä¹ ä»¥ä¸ºå¸¸çš„äº‹æƒ…äº§ç”Ÿäº† "æ–°æƒ³æ³•"ï¼Ÿ',
                        options: [
                            { text: 'ğŸ§˜ å®Œå…¨æ²¡æœ‰ï¼Œæˆ‘å¾ˆ "ç¨³"', score: 3, risk: 0, icon: 'ğŸ§˜' },
                            { text: 'ğŸ¤” å¶å°”æœ‰ï¼Œä½†å¾ˆå¿«å°± "ä¸‹å¤´" äº†', score: 1, risk: 0, icon: 'ğŸ¤”' },
                            { text: 'ğŸ˜µ ç»å¸¸æœ‰ï¼Œæ„Ÿè§‰ "æ•´ä¸ªäººéƒ½ä¸å¥½äº†"', score: 0, risk: 0, icon: 'ğŸ˜µ' }
                        ]
                    },
                    {
                        text: 'ä½ æ˜¯å¦æ›¾åœ¨ç½‘ä¸Šå‘è¡¨è¿‡è®©è‡ªå·± "ç¤¾æ­»" çš„è¨€è®ºï¼Ÿ',
                        options: [
                            { text: 'ğŸ„ ä»æ¥æ²¡æœ‰ï¼Œæˆ‘æ˜¯ "ç½‘ä¸Šå†²æµªå°èƒ½æ‰‹"', score: 3, risk: 0, icon: 'ğŸ„' },
                            { text: 'ğŸ˜… æœ‰è¿‡ä¸€æ¬¡ï¼Œç°åœ¨æƒ³æƒ³ "è„šè¶¾æŠ å‡ºä¸‰å®¤ä¸€å…"', score: 1, risk: 0, icon: 'ğŸ˜…' },
                            { text: 'ğŸ«£ å¤šæ¬¡ï¼Œå·²ç» "æ²¡è„¸è§äºº" äº†', score: 0, risk: 0, icon: 'ğŸ«£' }
                        ]
                    }
                ]
            },
            {
                id: 'research',
                title: 'ç¬¬ä¸‰å…³ï¼šç§‘ç ”æ‰“æ€ªï¼ˆå­¦ä¹ ç§‘ç ”ç»´åº¦ãƒ»ç»´åº¦åˆ† 10åˆ†)',
                achievement: 'ç§‘ç ”å¤§ä½¬',
                achievementId: 'research-achievement',
                questions: [
                    {
                        text: 'å¦‚æœç§‘ç ”æ˜¯ä¸€åœºæ¸¸æˆï¼Œä½ ç°åœ¨å¡åœ¨ç¬¬å‡ å…³ï¼Ÿ',
                        options: [
                            { text: 'ğŸ‰ ç¬¬ä¸€å…³ï¼šæ–°æ‰‹æ‘ï¼Œä¸€åˆ‡é¡ºåˆ©', score: 4, risk: 0, icon: 'ğŸ‰' },
                            { text: 'ğŸ› ï¸ ä¸­é—´å…³å¡ï¼šæœ‰ç‚¹éš¾åº¦ï¼Œä½†è¿˜èƒ½ "è‚"', score: 1, risk: 0, icon: 'ğŸ› ï¸' },
                            { text: 'ğŸš« æœ€ç»ˆ BOSSï¼šå®Œå…¨æ‰“ä¸è¿‡ï¼Œæƒ³ "åˆ å·é‡ç»ƒ"', score: 0, risk: 0, icon: 'ğŸš«' }
                        ]
                    },
                    {
                        text: 'ä½ çš„ç§‘ç ”å‹åŠ›è¾¾åˆ°äº†å“ªä¸ª "å¢ƒç•Œ"ï¼Ÿ',
                        options: [
                            { text: 'ğŸ¥‰ é’é“œï¼šå°åœºé¢ï¼Œæ¯«æ— å‹åŠ›', score: 3, risk: 0, icon: 'ğŸ¥‰' },
                            { text: 'ğŸ¥ˆ é»„é‡‘ï¼šæœ‰ç‚¹éš¾ï¼Œä½†è¿˜èƒ½ "è‹Ÿä½"', score: 1, risk: 0, icon: 'ğŸ¥ˆ' },
                            { text: 'ğŸ¥‡ ç‹è€…ï¼šå‹åŠ›å±±å¤§ï¼Œæ„Ÿè§‰è¦ "ç ´é˜²" äº†', score: 0, risk: 3, icon: 'ğŸ¥‡' }
                        ]
                    },
                    {
                        text: 'æœ€è¿‘ä½ çš„å®éªŒ / è®ºæ–‡æ˜¯å¦é‡åˆ°äº† "ç„å­¦" é—®é¢˜ï¼Ÿ',
                        options: [
                            { text: 'ğŸ“œ æ²¡æœ‰ï¼Œä¸€åˆ‡æŒ‰ "å‰§æœ¬" èµ°', score: 3, risk: 0, icon: 'ğŸ“œ' },
                            { text: 'ğŸ”„ å¶å°”æœ‰ï¼Œéœ€è¦ "é‡å¯" ä¸€ä¸‹', score: 1, risk: 0, icon: 'ğŸ”„' },
                            { text: 'ğŸ§Ÿ ç»å¸¸æœ‰ï¼Œæ„Ÿè§‰è¢« "è¯…å’’" äº†', score: 0, risk: 0, icon: 'ğŸ§Ÿ' }
                        ]
                    }
                ]
            },
            {
                id: 'mentor',
                title: 'ç¬¬å››å…³ï¼šå¯¼å¸ˆè”åŠ¨ï¼ˆå¯¼å­¦å…³ç³»ç»´åº¦ãƒ»ç»´åº¦åˆ† 10åˆ†)',
                achievement: 'å¯¼å­¦é»˜å¥‘ç‹',
                achievementId: 'mentor-achievement',
                questions: [
                    {
                        text: 'ä½ å’Œå¯¼å¸ˆçš„èŠå¤©æ¡†æ˜¯ä»€ä¹ˆçŠ¶æ€ï¼Ÿ',
                        options: [
                            { text: 'ğŸ’¬ æ¶ˆæ¯åˆ·å±ï¼Œæ¯å‘¨â‰¥2 æ¬¡æ²Ÿé€š', score: 4, risk: 0, icon: 'ğŸ’¬' },
                            { text: 'ğŸ“… å¶å°”å†’æ³¡ï¼Œæ¯æœˆ 1-2 æ¬¡æ²Ÿé€š', score: 1, risk: 0, icon: 'ğŸ“…' },
                            { text: 'ğŸš« å·²è¯»ä¸å›ï¼Œå‡ ä¹ä¸æ²Ÿé€š', score: 0, risk: 0, icon: 'ğŸš«' }
                        ]
                    },
                    {
                        text: 'ä½ å’Œå¯¼å¸ˆä¹‹é—´æ˜¯å¦å‡ºç°è¿‡ "å¤§å‹å°´å°¬ç°åœº"ï¼Ÿ',
                        options: [
                            { text: 'ğŸ¤ æ²¡æœ‰ï¼Œæˆ‘ä»¬æ˜¯ "æœ€ä½³æ‹æ¡£"', score: 3, risk: 0, icon: 'ğŸ¤' },
                            { text: 'ğŸ˜… å¶å°”æœ‰å°æ‘©æ“¦ï¼Œä½†èƒ½ "åŒ–è§£"', score: 1, risk: 0, icon: 'ğŸ˜…' },
                            { text: 'âš¡ ç»å¸¸æœ‰ï¼Œæ„Ÿè§‰åœ¨ "æ¸¡åŠ«"', score: 0, risk: 2, icon: 'âš¡' }
                        ]
                    },
                    {
                        text: 'ä½ çš„å¯¼å¸ˆæ˜¯å“ªç§ "ç±»å‹"ï¼Ÿ',
                        options: [
                            { text: 'ğŸ… é‡‘ç‰Œæ•™ç»ƒï¼šæŒ‡å¯¼è¶…è¯¦ç»†ï¼Œ"æ‰‹æŠŠæ‰‹" æ•™å­¦', score: 3, risk: 0, icon: 'ğŸ…' },
                            { text: 'ğŸ“ æ™®é€šå¯¼å¸ˆï¼šæœ‰æŒ‡å¯¼ï¼Œä½†éœ€è¦è‡ªå·± "æ‚Ÿ"', score: 1, risk: 0, icon: 'ğŸ“' },
                            { text: 'ğŸ•µï¸ ç¥ç§˜å¯¼å¸ˆï¼šåŸºæœ¬è§ä¸åˆ°ï¼Œåƒåœ¨ "ç©å¤±è¸ª"', score: 0, risk: 0, icon: 'ğŸ•µï¸' }
                        ]
                    }
                ]
            },
            {
                id: 'social',
                title: 'ç¬¬äº”å…³ï¼šäººé™…ç»„é˜Ÿï¼ˆäººé™…äº¤å¾€ç»´åº¦ãƒ»ç»´åº¦åˆ† 10åˆ†)',
                achievement: 'äººé™…å°å¤ªé˜³',
                achievementId: 'social-achievement',
                questions: [
                    {
                        text: 'ç”¨ä¸€ç§å¤©æ°”å½¢å®¹ä½ çš„å¯å®¤å…³ç³»ï¼Œæ˜¯å“ªä¸€ç§ï¼Ÿ',
                        options: [
                            { text: 'â˜€ï¸ æ™´å¤©ï¼šé˜³å…‰æ™®ç…§ï¼Œå’Œè°èæ´½', score: 4, risk: 0, icon: 'â˜€ï¸' },
                            { text: 'â›… å¤šäº‘ï¼šå¶å°”é˜´å¤©ï¼Œå¾ˆå¿«æ”¾æ™´', score: 1, risk: 0, icon: 'â›…' },
                            { text: 'ğŸŒ§ï¸ æš´é›¨ï¼šç»å¸¸ "ç”µé—ªé›·é¸£"ï¼Œæƒ³ "é€ƒç¦»"', score: 0, risk: 2, icon: 'ğŸŒ§ï¸' }
                        ]
                    },
                    {
                        text: 'ä½ å¯¹é›†ä½“æ´»åŠ¨çš„ "å¥”èµ´æ¬²" æœ‰å¤šå¼ºï¼Ÿ',
                        options: [
                            { text: 'ğŸƒâ€â™‚ï¸ å†²é”‹é€‰æ‰‹ï¼š"å›¢å»ºç‹‚é­”"ï¼Œå¿…é¡»å‚åŠ ', score: 3, risk: 0, icon: 'ğŸƒâ€â™‚ï¸' },
                            { text: 'ğŸš¶ éšç¼˜é€‰æ‰‹ï¼šçœ‹å¿ƒæƒ…ï¼Œ"å»ä¸å»éƒ½è¡Œ"', score: 1, risk: 0, icon: 'ğŸš¶' },
                            { text: 'ğŸšª å®…å®¶é€‰æ‰‹ï¼šèƒ½ä¸å»å°±ä¸å»ï¼Œ"ç¤¾æ" æ™šæœŸ', score: 0, risk: 0, icon: 'ğŸšª' }
                        ]
                    },
                    {
                        text: 'æœ€è¿‘ä½ æ˜¯å¦ç»å†è¿‡ "äººé™…å…³ç³»å±æœº"ï¼Ÿ',
                        options: [
                            { text: 'ğŸ›¡ï¸ æ²¡æœ‰ï¼Œæˆ‘çš„äººé™…å…³ç³» "ç¨³å¦‚è€ç‹—"', score: 3, risk: 0, icon: 'ğŸ›¡ï¸' },
                            { text: 'ğŸ§© æœ‰ä¸€ç‚¹å°é—®é¢˜ï¼Œä½†èƒ½è‡ªå·±è§£å†³', score: 1, risk: 0, icon: 'ğŸ§©' },
                            { text: 'ğŸ’” é—®é¢˜ä¸¥é‡ï¼Œæ„Ÿè§‰è¦ "ç»äº¤" äº†', score: 0, risk: 0, icon: 'ğŸ’”' }
                        ]
                    }
                ]
            },
            {
                id: 'mental',
                title: 'ç¬¬å…­å…³ï¼šå¿ƒæƒ…ç»­èˆªï¼ˆå¿ƒç†å¥åº·ç»´åº¦ãƒ»ç»´åº¦åˆ† 15åˆ†)',
                questions: [
                    {
                        text: 'æœ€è¿‘ä½ çš„ "å¿ƒæƒ…å¤©æ°”"æ˜¯ä»€ä¹ˆæ ·ï¼Ÿ',
                        options: [
                            { text: 'â˜€ æ™´å¤©ï¼šç§¯æç¨³å®šï¼Œæ­£èƒ½é‡æ»¡æ»¡', score: 5, risk: 0, icon: 'â˜€' },
                            { text: 'â›… å¤šäº‘ï¼šå¶å°”ä½è½/ç„¦è™‘ï¼Œå¾ˆå¿«æ¢å¤', score: 1, risk: 0, icon: 'â›…' },
                            { text: 'ğŸŸ¥ é›¨å¤©ï¼šæŒç»­ emoï¼Œæ„Ÿè§‰ "å¼€å¿ƒä¸èµ·æ¥"', score: 0, risk: 5, icon: 'ğŸŒ§ï¸' }
                        ]
                    },
                    {
                        text: 'ä½ æ˜¯å¦æœ‰ç¡çœ éšœç¢ã€è‡ªæˆ‘å¦å®šç­‰å¿ƒç† "å°ç—‡çŠ¶"ï¼Ÿ',
                        options: [
                            { text: 'ğŸ›¡ï¸ æ²¡æœ‰ï¼Œæˆ‘æ˜¯ "å¿ƒç†å¥åº·å°å«å£«"', score: 5, risk: 0, icon: 'ğŸ›¡ï¸' },
                            { text: 'âš ï¸ å¶å°”å‡ºç°ï¼Œ"å°é—®é¢˜ä¸å½±å“"', score: 1, risk: 0, icon: 'âš ï¸' },
                            { text: 'ğŸ¥ é¢‘ç¹å‡ºç°ï¼Œæ„Ÿè§‰éœ€è¦ "çœ‹åŒ»ç”Ÿ"', score: 0, risk: 0, icon: 'ğŸ¥' }
                        ]
                    },
                    {
                        text: 'ç”Ÿæ´»éš¾æ±æ—¶ï¼Œä½ æ˜¯å¦æœ‰è¿‡ "æƒ³å½»åº•èººå¹³"çš„å¿µå¤´ï¼Ÿ',
                        options: [
                            { text: 'ğŸ’ª åšå¼ºæˆ˜å£«ï¼šä»æ¥æ²¡æœ‰', score: 5, risk: 0, icon: 'ğŸ’ª' },
                            { text: 'ğŸ˜´ çŸ­æš‚ç–²æƒ«ï¼šå¶å°”é—ªè¿‡ä½†å¾ˆå¿«æ¸…é†’', score: 1, risk: 0, icon: 'ğŸ˜´' },
                            { text: 'ğŸš¨ çº¢è‰²è­¦æŠ¥ï¼šé¢‘ç¹å‡ºç°ï¼Œæ„Ÿè§‰ "æ’‘ä¸ä¸‹å»"', score: 0, risk: 10, icon: 'ğŸš¨' }
                        ]
                    }
                ],
                note: 'æœ¬å…³æç¤ºï¼šé€‰æ‹©çº¢è‰²è­¦æŠ¥é€‰é¡¹æ— éœ€ææ…Œï¼Œå­¦æ ¡å°†ä¸ºä½ å¯¹æ¥ä¸“ä¸šå¿ƒç†å¸®æ‰¶'
            },
            {
                id: 'career',
                title: 'ç¬¬ä¸ƒå…³ï¼šèŒä¸šæ¢è·¯ï¼ˆèŒä¸šå‘å±•ç»´åº¦ãƒ»ç»´åº¦åˆ† 10åˆ†)',
                achievement: 'èŒä¸šè§„åˆ’å¸ˆ',
                achievementId: 'career-achievement',
                questions: [
                    {
                        text: 'ä½ çš„äººç”Ÿå‰§æœ¬æ€ï¼ŒèŒä¸šçº¿è§£é”åˆ°å“ªä¸€å¹•ï¼Ÿ',
                        options: [
                            { text: 'ğŸ“œ ç¬¬ä¸€å¹•ï¼šè§„åˆ’æ¸…æ™°ä¸”æœ‰è¡ŒåŠ¨', score: 4, risk: 0, icon: 'ğŸ“œ' },
                            { text: 'ğŸš§ ç¬¬äºŒå¹•ï¼šæœ‰åˆæ­¥è§„åˆ’ä½†æ— è¡ŒåŠ¨', score: 1, risk: 0, icon: 'ğŸš§' },
                            { text: 'â“ ç¬¬ä¸‰å¹•ï¼šç©ºç™½å‰§æœ¬ï¼Œå®Œå…¨æ— è§„åˆ’', score: 0, risk: 0, icon: 'â“' }
                        ]
                    },
                    {
                        text: 'ä½ çš„æ±‚èŒè·¯ä¸Šé‡åˆ°è¿‡å¤šå°‘ "æš´å‡»"ï¼Ÿ',
                        options: [
                            { text: 'ğŸ® ä¸€è·¯å¼€æŒ‚ï¼šæ— æŒ«æŠ˜ï¼Œofferæ‹¿åˆ°æ‰‹è½¯', score: 3, risk: 0, icon: 'ğŸ®' },
                            { text: 'ğŸ”„ åŸåœ°å¤æ´»ï¼š1-2æ¬¡æŒ«æŠ˜ï¼Œèƒ½å¿«é€Ÿè°ƒæ•´', score: 1, risk: 0, icon: 'ğŸ”„' },
                            { text: 'ğŸ’” å¿ƒæ€å´©äº†ï¼šå¤šæ¬¡å¤±è´¥ï¼Œå·²äº§ç”Ÿå¿ƒç†é˜´å½±', score: 0, risk: 0, icon: 'ğŸ’”' }
                        ]
                    },
                    {
                        text: 'ä½ æ˜¯å¦é”™è¿‡äº† "ä¸Šå²¸"å…³é”®çª—å£æœŸï¼Ÿ',
                        options: [
                            { text: 'ğŸ¯ æ²¡æœ‰ï¼Œæˆ‘æ˜¯ "offeræ”¶å‰²æœº"', score: 3, risk: 0, icon: 'ğŸ¯' },
                            { text: 'â³ é”™è¿‡äº†ä¸€æ¬¡ï¼Œä½†è¿˜æœ‰æœºä¼š', score: 1, risk: 0, icon: 'â³' },
                            { text: 'âŒ å…¨é”™è¿‡äº†ï¼Œæ„Ÿè§‰è¦ "å¤±ä¸š"', score: 0, risk: 2, icon: 'âŒ' }
                        ]
                    }
                ]
            },
            {
                id: 'risk',
                title: 'ç¬¬å…«å…³ï¼šé£é™©æ’æŸ¥ï¼ˆé‡ç‚¹å…³æ³¨ç»´åº¦ãƒ»ç»´åº¦åˆ† 8åˆ†)',
                questions: [
                    {
                        text: 'ä½ æ˜¯å¦æœ‰è¿‡ "è¿è§„æ“ä½œ"è¢«è­¦å‘Šçš„ç»å†ï¼Ÿ',
                        options: [
                            { text: 'ğŸ“ ä¸‰å¥½å­¦ç”Ÿï¼šæ— ä»»ä½•å¤„åˆ†', score: 4, risk: 0, icon: 'ğŸ“' },
                            { text: 'âš ï¸ ä¸€æ¬¡è­¦å‘Šï¼šæ›¾æœ‰å•æ¬¡å¤„åˆ†', score: 1, risk: 0, icon: 'âš ï¸' },
                            { text: 'ğŸš« é»‘åå•ï¼šå¤šæ¬¡è¿çºª', score: 0, risk: 3, icon: 'ğŸš«' }
                        ]
                    },
                    {
                        text: 'ä½ æ˜¯ "ç¥ç§˜å¤±è¸ªäººå£"å—ï¼Ÿ',
                        options: [
                            { text: 'ğŸ“ æŒ‰æ—¶æ‰“å¡ï¼šæ ¡å†…ä½å®¿ï¼Œå¯éšæ—¶è”ç³»', score: 4, risk: 0, icon: 'ğŸ“' },
                            { text: 'ğŸ“± å¶å°”å¤±è”ï¼šæ ¡å¤–ä½å®¿ä½†èƒ½è”ç³»ä¸Š', score: 1, risk: 0, icon: 'ğŸ“±' },
                            { text: 'ğŸ‰ ç¥é¾™è§é¦–ä¸è§å°¾ï¼šé•¿æœŸæ ¡å¤–ä½å®¿ä¸”éš¾è”ç³»', score: 0, risk: 0, icon: 'ğŸ‰' }
                        ]
                    }
                ]
            },
            {
                id: 'hidden',
                title: 'ç¬¬ä¹å…³ï¼šéšè—å…³å¡ï¼ˆå…¶ä»–è¡¥å……ç»´åº¦ãƒ»ä¸è®¡åˆ†)',
                questions: [
                    {
                        text: 'ä½ æ˜¯å¦æœ‰å…¶ä»– "éšè—å…³å¡"éœ€è¦è§£é”ï¼Ÿ',
                        options: [
                            { text: 'âŒ æ— éšè—å…³å¡ï¼ˆæ— å›°éš¾ï¼‰', score: 0, risk: 0, icon: 'âŒ' },
                            { 
                                text: 'âœ¨ å°éšè—å…³ï¼ˆæœ‰å°‘é‡æœªæåŠå›°éš¾ï¼‰', 
                                score: 0, 
                                risk: 0, 
                                icon: 'âœ¨',
                                input: true
                            },
                            { 
                                text: 'ğŸ”¥ hardæ¨¡å¼ï¼ˆæœ‰è¾ƒå¤šå›°éš¾ï¼‰', 
                                score: 0, 
                                risk: 0, 
                                icon: 'ğŸ”¥',
                                input: true
                            }
                        ]
                    },
                    {
                        text: 'ä½ æ„¿æ„è®© "å¿ƒçµå¯¼å¸ˆ"å¸®ä½ è§£å‹å—ï¼Ÿ',
                        options: [
                            { text: 'â˜• éå¸¸æ„¿æ„ï¼Œæ€¥éœ€ "å¿ƒçµæŒ‰æ‘©"', score: 0, risk: 0, icon: 'â˜•' },
                            { text: 'ğŸ‘¤ æ„¿æ„ï¼Œä½†æœ‰ç‚¹ "ç¤¾æ"', score: 0, risk: 0, icon: 'ğŸ‘¤' },
                            { text: 'ğŸ¤« æš‚ä¸æ„¿æ„ï¼Œæƒ³å…ˆ "é™é™"', score: 0, risk: 0, icon: 'ğŸ¤«' }
                        ]
                    },
                    {
                        text: 'å¦‚æœå¯ä»¥ "è®¸æ„¿"ï¼Œä½ æœ€æƒ³è¦ä»€ä¹ˆå¸®åŠ©ï¼Ÿï¼ˆå¯å¤šé€‰ï¼‰',
                        isMultiple: true,
                        options: [
                            { text: 'ğŸ“š ç§‘ç ”æŠ€èƒ½æå‡åŒ…', score: 0, risk: 0, icon: 'ğŸ“š' },
                            { text: 'ğŸ’¬ è°ˆå¿ƒè°ˆè¯ä¸“å±é€šé“', score: 0, risk: 0, icon: 'ğŸ’¬' },
                            { text: 'ğŸ¯ èŒä¸šè§„åˆ’åŠ é€Ÿå™¨', score: 0, risk: 0, icon: 'ğŸ¯' },
                            { text: 'ğŸ‘¥ ç¤¾äº¤èƒ½åŠ›å¢å¼ºå‰‚', score: 0, risk: 0, icon: 'ğŸ‘¥' },
                            { text: 'ğŸ§  å¿ƒç†å¥åº·èƒ½é‡ç«™', score: 0, risk: 0, icon: 'ğŸ§ ' },
                            { text: 'ğŸ’° ç»æµæ”¯æŒè¡¥ç»™ç®±', score: 0, risk: 0, icon: 'ğŸ’°' }
                        ]
                    }
                ]
            }
        ];

        // æ¸¸æˆçŠ¶æ€
        const gameState = {
            currentScreen: 'start',
            currentStage: 0,
            totalScore: 0,
            totalRisk: 0,
            userInfo: {},
            answers: {}
        };

        // DOMå…ƒç´ 
        const screens = {
            start: document.getElementById('start-screen'),
            info: document.getElementById('info-screen'),
            question: document.getElementById('question-screen'),
            result: document.getElementById('result-screen'),
            submitSuccess: document.getElementById('submit-success-screen')
        };

        // æŒ‰é’®å…ƒç´ 
        const buttons = {
            start: document.getElementById('start-btn'),
            infoNext: document.getElementById('info-next-btn'),
            next: document.getElementById('next-btn'),
            submitData: document.getElementById('submit-data-btn'),
            restart: document.getElementById('restart-btn'),
            backToHome: document.getElementById('back-to-home-btn')
        };

        // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬
        function initEventListeners() {
            buttons.start.addEventListener('click', () => {
                switchScreen('info');
            });

            buttons.infoNext.addEventListener('click', () => {
                if (validateInfoForm()) {
                    saveUserInfo();
                    gameState.totalScore = 20;
                    document.getElementById('base-score').textContent = '20';
                    document.getElementById('current-score').textContent = '20';
                    updateCharacterPreview();
                    switchScreen('question');
                    loadStage(gameState.currentStage);
                }
            });

            buttons.next.addEventListener('click', () => {
                saveStageAnswers();
                gameState.currentStage++;
                if (gameState.currentStage < quizData.length) {
                    loadStage(gameState.currentStage);
                } else {
                    calculateResult();
                    switchScreen('result');
                }
            });

            buttons.submitData.addEventListener('click', () => {
                switchScreen('submitSuccess');
            });

            buttons.restart.addEventListener('click', resetGame);
            buttons.backToHome.addEventListener('click', resetGame);

            document.querySelectorAll('.gender-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.gender-option').forEach(opt => opt.classList.remove('selected'));
                    this.classList.add('selected');
                    validateInfoForm();
                });
            });

            document.getElementById('student-id').addEventListener('input', validateInfoForm);
            document.getElementById('name').addEventListener('input', validateInfoForm);
            document.getElementById('grade').addEventListener('change', validateInfoForm);
            document.getElementById('teacher').addEventListener('input', validateInfoForm);
            document.getElementById('major').addEventListener('input', validateInfoForm);
            
            document.getElementById('grade').addEventListener('change', updateCharacterPreview);
            document.getElementById('teacher').addEventListener('input', updateCharacterPreview);
            document.getElementById('major').addEventListener('input', updateCharacterPreview);
        }

        function switchScreen(screenName) {
            Object.keys(screens).forEach(key => screens[key].classList.remove('active'));
            screens[screenName].classList.add('active');
            gameState.currentScreen = screenName;
        }

        function validateInfoForm() {
            let isValid = true;
            const studentId = document.getElementById('student-id').value;
            const name = document.getElementById('name').value;
            const grade = document.getElementById('grade').value;
            const teacher = document.getElementById('teacher').value;
            const major = document.getElementById('major').value;
            const genderSelected = document.querySelector('.gender-option.selected') !== null;

            if (studentId.length !== 8 || isNaN(studentId)) {
                document.getElementById('student-id-error').style.display = 'block';
                isValid = false;
            } else {
                document.getElementById('student-id-error').style.display = 'none';
            }

            if (!name.trim()) {
                document.getElementById('name-error').style.display = 'block';
                isValid = false;
            } else {
                document.getElementById('name-error').style.display = 'none';
            }

            if (!genderSelected) {
                document.getElementById('gender-error').style.display = 'block';
                isValid = false;
            } else {
                document.getElementById('gender-error').style.display = 'none';
            }

            if (!grade) {
                document.getElementById('grade-error').style.display = 'block';
                isValid = false;
            } else {
                document.getElementById('grade-error').style.display = 'none';
            }

            if (!teacher.trim()) {
                document.getElementById('teacher-error').style.display = 'block';
                isValid = false;
            } else {
                document.getElementById('teacher-error').style.display = 'none';
            }

            if (!major.trim()) {
                document.getElementById('major-error').style.display = 'block';
                isValid = false;
            } else {
                document.getElementById('major-error').style.display = 'none';
            }

            buttons.infoNext.disabled = !isValid;
            return isValid;
        }

        function saveUserInfo() {
            gameState.userInfo = {
                studentId: document.getElementById('student-id').value,
                name: document.getElementById('name').value,
                gender: document.querySelector('.gender-option.selected').dataset.value,
                grade: document.getElementById('grade').value,
                teacher: document.getElementById('teacher').value,
                major: document.getElementById('major').value
            };
        }

        function updateCharacterPreview() {
            const grade = document.getElementById('grade').value;
            const teacher = document.getElementById('teacher').value;
            const major = document.getElementById('major').value;
            
            let roleText = 'ä¸Šå¤§èŒæ–°é¼ ï¼ˆçŠ¶æ€å¾…å®šï¼‰';
            if (grade) {
                const roleMap = {
                    'ç¡•å£«ä¸€å¹´çº§': 'ä¸Šå¤§èŒæ–°é¼ ',
                    'ç¡•å£«äºŒå¹´çº§': 'ä¸Šå¤§å¥‹æ–—å…”',
                    'ç¡•å£«ä¸‰å¹´çº§': 'ä¸Šå¤§æ¯•ä¸šé¾™'
                };
                roleText = roleMap[grade] || roleText;
            }
            
            let collegeMajorText = 'æœªè®¾ç½®';
            if (teacher && major) {
                collegeMajorText = `${teacher}å¸ˆé—¨ Â· ${major}`;
            } else if (teacher) {
                collegeMajorText = `${teacher}å¸ˆé—¨`;
            } else if (major) {
                collegeMajorText = major;
            }
            
            let gradeText = 'æœªè®¾ç½®';
            if (grade) {
                gradeText = grade;
            }
            
            document.getElementById('preview-role').textContent = roleText;
            document.getElementById('preview-college-major').textContent = collegeMajorText;
            document.getElementById('preview-grade').textContent = gradeText;
        }

        function loadStage(stageIndex) {
            const stage = quizData[stageIndex];
            document.getElementById('stage-title').textContent = stage.title;
            document.getElementById('current-stage').textContent = stageIndex + 1;
            
            const progress = ((stageIndex + 1) / quizData.length) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;
            
            const questionsContainer = document.getElementById('questions-container');
            questionsContainer.innerHTML = '';
            
            stage.questions.forEach((question, qIndex) => {
                const questionEl = document.createElement('div');
                questionEl.className = 'question';
                questionEl.dataset.index = qIndex;
                
                const questionText = document.createElement('p');
                questionText.textContent = `${qIndex + 1}. ${question.text}`;
                questionEl.appendChild(questionText);
                
                const optionsContainer = document.createElement('div');
                optionsContainer.className = question.isMultiple ? 'multi-select' : 'options';
                
                question.options.forEach((option, oIndex) => {
                    const optionEl = document.createElement('div');
                    optionEl.className = question.isMultiple ? 'multi-option' : 'option';
                    optionEl.dataset.question = qIndex;
                    optionEl.dataset.option = oIndex;
                    
                    const labelEl = document.createElement('div');
                    labelEl.className = 'option-label';
                    
                    const iconEl = document.createElement('span');
                    iconEl.className = 'option-icon';
                    iconEl.textContent = option.icon;
                    
                    const textEl = document.createElement('span');
                    textEl.textContent = option.text;
                    
                    labelEl.appendChild(iconEl);
                    labelEl.appendChild(textEl);
                    optionEl.appendChild(labelEl);
                    
                    if (option.input) {
                        const inputEl = document.createElement('textarea');
                        inputEl.className = 'hidden-input';
                        inputEl.placeholder = 'è¯·è¾“å…¥å…·ä½“æƒ…å†µ...';
                        inputEl.style.display = 'none';
                        inputEl.dataset.question = qIndex;
                        inputEl.dataset.option = oIndex;
                        optionEl.appendChild(inputEl);
                    }
                    
                    optionEl.addEventListener('click', function() {
                        if (question.isMultiple) {
                            this.classList.toggle('selected');
                        } else {
                            optionsContainer.querySelectorAll('.option').forEach(opt => {
                                opt.classList.remove('selected');
                                const input = opt.querySelector('.hidden-input');
                                if (input) input.style.display = 'none';
                            });
                            this.classList.add('selected');
                            const input = this.querySelector('.hidden-input');
                            if (input) input.style.display = 'block';
                        }
                        checkStageCompletion(stageIndex);
                    });
                    
                    optionsContainer.appendChild(optionEl);
                });
                
                questionEl.appendChild(optionsContainer);
                questionsContainer.appendChild(questionEl);
            });
            
            const noteContainer = document.getElementById('note-container');
            if (stage.note) {
                noteContainer.textContent = stage.note;
                noteContainer.style.display = 'block';
            } else {
                noteContainer.style.display = 'none';
            }
            
            buttons.next.disabled = true;
        }

        function checkStageCompletion(stageIndex) {
            const stage = quizData[stageIndex];
            let isComplete = true;
            
            stage.questions.forEach((question, qIndex) => {
                const selectedOptions = document.querySelectorAll(`.question[data-index="${qIndex}"] .option.selected, .question[data-index="${qIndex}"] .multi-option.selected`);
                
                if (question.isMultiple) {
                    if (selectedOptions.length === 0) isComplete = false;
                } else {
                    if (selectedOptions.length !== 1) isComplete = false;
                }
            });
            
            buttons.next.disabled = !isComplete;
        }

        function saveStageAnswers() {
            const stage = quizData[gameState.currentStage];
            const stageAnswers = [];
            let stageScore = 0;
            let stageRisk = 0;
            
            stage.questions.forEach((question, qIndex) => {
                const questionAnswers = { question: question.text, selections: [] };
                const selectedOptions = document.querySelectorAll(`.question[data-index="${qIndex}"] .option.selected, .question[data-index="${qIndex}"] .multi-option.selected`);
                
                selectedOptions.forEach(option => {
                    const oIndex = parseInt(option.dataset.option);
                    const selectedOption = question.options[oIndex];
                    
                    const selection = {
                        text: selectedOption.text,
                        score: selectedOption.score,
                        risk: selectedOption.risk
                    };
                    
                    if (selectedOption.input) {
                        const input = option.querySelector('.hidden-input');
                        if (input) selection.input = input.value;
                    }
                    
                    questionAnswers.selections.push(selection);
                    stageScore += Number(selectedOption.score) || 0;
                    stageRisk += Number(selectedOption.risk) || 0;
                });
                
                stageAnswers.push(questionAnswers);
            });
            
            gameState.answers[gameState.currentStage] = stageAnswers;
            gameState.totalScore += stageScore;
            gameState.totalRisk += stageRisk;
            document.getElementById('current-score').textContent = gameState.totalScore;
        }

        function calculateResult() {
            const finalScore = Math.min(gameState.totalScore, 100);
            document.getElementById('final-score').textContent = finalScore;
            
            let survivalLevel;
            if (finalScore >= 90) survivalLevel = 'SSSçº§ç”Ÿå­˜å¤§å¸ˆ';
            else if (finalScore >= 80) survivalLevel = 'SSçº§ç”Ÿå­˜é«˜æ‰‹';
            else if (finalScore >= 70) survivalLevel = 'Sçº§ç”Ÿå­˜è¾¾äºº';
            else if (finalScore >= 60) survivalLevel = 'Açº§ç”Ÿå­˜è€…';
            else survivalLevel = 'Bçº§ç”Ÿå­˜è€…';
            document.getElementById('survival-level').textContent = survivalLevel;
            
            let reportText = '';
            if (gameState.totalRisk > 10) {
                reportText += 'ä½ çš„æ ¡å›­ç”Ÿå­˜æŒ‘æˆ˜ä¸­é‡åˆ°äº†ä¸€äº›è¾ƒå¤§çš„å›°éš¾ï¼Œå»ºè®®åŠæ—¶ä¸è¾…å¯¼å‘˜æˆ–å¿ƒç†è€å¸ˆæ²Ÿé€šã€‚';
            } else if (gameState.totalRisk > 0) {
                reportText += 'ä½ çš„æ ¡å›­ç”Ÿæ´»æœ‰ä¸€äº›éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œé€‚å½“è°ƒæ•´çŠ¶æ€ä¼šæ›´å¥½ã€‚';
            } else {
                reportText += 'æ­å–œä½ ï¼ä½ çš„æ ¡å›­ç”Ÿæ´»çŠ¶æ€è‰¯å¥½ï¼Œç»§ç»­ä¿æŒå“¦ï¼';
            }
            reportText += ' å­¦æ ¡ä¼šæ ¹æ®ä½ çš„æƒ…å†µæä¾›ç›¸åº”çš„æ”¯æŒå’Œå¸®åŠ©ã€‚';
            document.getElementById('report-text').textContent = reportText;
            
            quizData.forEach((stage, index) => {
                if (stage.achievementId && gameState.answers[index]) {
                    try {
                        const stageScore = gameState.answers[index].reduce((sum, q) => {
                            return sum + q.selections.reduce((qSum, s) => qSum + (Number(s.score) || 0), 0);
                        }, 0);
                        
                        const maxStageScore = stage.questions.reduce((sum, q) => {
                            return sum + q.options.reduce((oSum, o) => Math.max(oSum, Number(o.score) || 0), 0);
                        }, 0);
                        
                        if (maxStageScore > 0 && (stageScore / maxStageScore) > 0.6) {
                            const achievementEl = document.getElementById(stage.achievementId);
                            if (achievementEl) achievementEl.classList.add('unlocked');
                        }
                    } catch (e) {
                        console.log(`æˆå°±è§£é”è®¡ç®—é”™è¯¯ï¼ˆå…³å¡${index+1}ï¼‰ï¼š`, e);
                    }
                }
            });
        }

        function resetGame() {
            gameState.currentStage = 0;
            gameState.totalScore = 0;
            gameState.totalRisk = 0;
            gameState.userInfo = {};
            gameState.answers = {};
            
            document.getElementById('student-id').value = '';
            document.getElementById('name').value = '';
            document.getElementById('grade').value = '';
            document.getElementById('teacher').value = '';
            document.getElementById('major').value = '';
            document.querySelectorAll('.gender-option').forEach(opt => opt.classList.remove('selected'));
            document.getElementById('base-score').textContent = '0';
            document.getElementById('current-score').textContent = '0';
            updateCharacterPreview();
            
            document.querySelectorAll('.achievement').forEach(ach => ach.classList.remove('unlocked'));
            switchScreen('start');
        }

        function initGame() {
            initEventListeners();
        }

        window.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
